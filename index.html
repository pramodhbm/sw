<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample HTML Page</title>
</head>
<body>

  <button onclick="subscribe()" >Subscribe</button>

  <script>
    addEventListener('load', async () => {
      console.log("Page has fully loaded");
      let sw = await navigator.serviceWorker.register('/sw.js');
      console.log("Service Worker registered:", sw);
    });


    async function subscribe() {
      alert("Thank you for subscribing!");
      let sw = await navigator.serviceWorker.ready;
      let push = await sw.pushManager.subscribe({
        userVisibleOnly: true,
        applicationServerKey: 'BDJC1medoCtJ_T7gY3Pk78WtEJklpL9zBMjqF2f3m6ijU--oORl22bmwFXQ7HHXUccdrauAz3AEOgpDonATwYcA'
      });
      console.log(JSON.stringify(push));
    }

    navigator.serviceWorker.addEventListener('message', event => {
      if (event.data.type === 'PUSH_RECEIVED') {
        // Handle push data when page is active
        console.log('Push received while page active:', event.data.data);
        // Show in-page notification, update UI, etc.
      }
    });
  </script>
</body>
</html>